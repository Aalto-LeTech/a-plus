{% extends "course/course_base.html" %}
{% load i18n %}
{% load course %}

{% block coursecontent %}

<h2>{% trans "Teacher's view" %}</h2>

<h3>{% trans "Exercise categories" %}</h3>
<table class="table table-striped table-bordered table-condensed">
    <tbody>
        {% for category in instance.categories.all %}
        <tr>
            <td>
                {{ category.name }}
            </td>
            <td>
                <a class="btn btn-mini" href="{% url 'model-edit' course=course.url instance=instance.url model='category' id=category.id %}">
                    <i class="icon-edit"></i> {% trans "Edit category" %}
                </a>
                {% if category.learning_objects.count == 0 %}
                <a class="btn btn-mini" href="{% url 'model-remove' course=course.url instance=instance.url model='category' id=category.id %}">
                	<i class="icon-remove"></i> {% trans "Remove" %}
                </a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
        <tr>
            <th colspan="2">
                <a class="btn btn-primary btn-mini" href="{% url 'model-create' course=course.url instance=instance.url model='category' %}">
                    <i class="icon-plus-sign icon-white"></i> {% trans "Add new category" %}
                </a>
            </th>
        </tr>
    </tbody>
</table>

<h3>{% trans "Course modules" %}</h3>
<table class="table table-striped table-bordered table-condensed">
    <tbody>
        {% for module in instance.course_modules.all %}
        <tr>
            <th><strong>{{ module }}</strong></th>
            <td>
                <a class="btn btn-mini" href="{% url 'model-edit' course=course.url instance=instance.url model='module' id=module.id %}">
                    <i class="icon-edit"></i> {% trans "Edit module" %}
                </a>
                {% if module.learning_objects.count == 0 %}
                <a class="btn btn-mini" href="{% url 'model-remove' course=course.url instance=instance.url model='module' id=module.id %}">
                	<i class="icon-remove"></i> {% trans "Remove" %}
                </a>
                {% endif %}
                <a class="btn btn-mini btn-link" href="{{ module|url }}">
                    {% trans "Open module" %}
                </a>
            </td>
        </tr>
        {% for object in module.chapters.all %}
        <tr>
            <td>
                {{ object }}
            </td>
            <td>
                <a class="btn btn-mini" href="{% url 'model-edit' course=course.url instance=instance.url model='chapter' id=object.id %}">
                    <i class="icon-edit"></i> {% trans "Edit chapter" %}
                </a>
                <a class="btn btn-mini" href="{% url 'model-remove' course=course.url instance=instance.url model='chapter' id=object.id %}">
                    <i class="icon-remove"></i> {% trans "Remove" %}
                </a>
                <a class="btn btn-mini btn-link" href="{{ object|url }}">
                    {% trans "Open chapter" %}
                </a>
            </td>
        </tr>
        {% endfor %}
        <tr>
            <td colspan="2">
                <a class="btn btn-mini btn-success" href="{% url 'model-create-for' course=course.url instance=instance.url model='chapter' parent_id=module.id %}">
                    {% trans "Add new chapter" %}
                </a>
            </td>
        </tr>
        {% for object in module.learning_objects.all %}
        <tr>
            <td>
                {{ object }}
            </td>
            <td>
                <a class="btn btn-mini" href="{% url 'model-edit' course=course.url instance=instance.url model='exercise' id=object.id %}">
                    <i class="icon-edit"></i> {% trans "Edit exercise" %}
                </a>
                <a class="btn btn-mini" href="{% url 'model-remove' course=course.url instance=instance.url model='exercise' id=object.id %}">
                    <i class="icon-remove"></i> {% trans "Remove" %}
                </a>
                <a class="btn btn-mini btn-link" href="{{ object|url }}">
                	{% trans "Open exercise" %}
                </a>
                <a class="btn btn-mini btn-link" href="{{ object|url:'submission-list' }}">
                	{% trans "View submissions" %}
                </a>
            </td>
        </tr>
        {% endfor %}
        <tr>
            <td colspan="2">
                <div class="btn-group">
                    <a class="btn btn-mini btn-success" href="{% url 'model-create-for' course=course.url instance=instance.url model='exercise' parent_id=module.id %}">
                        {% trans "Add new exercise" %}
                    </a>
                    <button type="button" class="btn btn-mini dropdown-toggle" data-toggle="dropdown">
                      <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li>
                            <a href="{% url 'model-create-for' course=course.url instance=instance.url model='exercise' parent_id=module.id %}">
                                {% trans "Add exercise" %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'model-create-type-for' course=course.url instance=instance.url model='exercise' parent_id=module.id type='static' %}">
                                {% trans "Add static exercise" %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'model-create-type-for' course=course.url instance=instance.url model='exercise' parent_id=module.id type='attachment' %}">
                                {% trans "Add exercise with attachment" %}
                            </a>
                        </li>
                    </ul>
                </div>
            </td>
        </tr>
        {% endfor %}
        <tr>
            <th colspan="2">
                <a class="btn btn-primary btn-mini" href="{% url 'model-create' course=course.url instance=instance.url model='module' %}">
                    <i class="icon-plus-sign icon-white"></i> {% trans "Add new module" %}
                </a>
            </th>
        </tr>
    </tbody>
</table>

<h3>{% trans "Deadline Rule Deviations" %}</h3>
<p>{% trans "Add or view personalized deadlines for students for exercises." %}</p>
<a class="btn btn-primary btn-mini" href="{{ instance|url:'deviations-add-dl' }}">
    <i class="icon-plus-sign icon-white"></i> {% trans "Add Deadline Deviations" %}
</a>
<a class="btn btn-primary btn-mini" href="{{ instance|url:'deviations-list-dl' }}">
    <i class="icon-list-alt icon-white"></i> {% trans "List Deadline Deviations" %}
</a>

<div class="col-sm-10">
	{% blocktrans %}
	<h3>Batch Create and Assess Submissions</h3>
	<p><em>Use only if you know what you are doing!</em></p>
	<p>By submitting json to the form below you can try to create and assess multiple exercises for students automatically.</p>
	<div>
		<p>XXXXX1 and XXXXX2 are the real student ids</p>
		<p>X1 (integer) is the A+ userprofile id of the desired grader</p>
		<p>Z1 and Z2 (integers) are A+ exercise ids</p>

		<pre>{
  "objects": [
    {
      "students_by_student_id": [
        "XXXXX1"
      ],
      "feedback": "Nicely solved exercise!",
      "grader": X1,
      "exercise_id": Z1,
      "submission_time": "2014-09-24 11:50",
      "points": 100
    },
    {
      "students_by_student_id": [
        "XXXXX2"
      ],
      "feedback": "You can do better!",
      "grader": X1,
      "exercise_id": Z2,
      "submission_time": "2014-09-24 11:50",
      "points": 20
    }
  ]
}
		</pre>
	</div>
   {% endblocktrans %}
</div>
<form method="post" action="{{ instance|url:'batch-assess' }}">
	{% csrf_token %}
    <textarea name="submissions_json"></textarea>
    <button type="submit" class="btn">{% trans "Submit" %}</button>
</form>

{% endblock %}
